<Window x:Class="ARK_Server_Manager.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:globcntrls="clr-namespace:WPFSharp.Globalizer.Controls;assembly=WPFSharp.Globalizer"
        xmlns:Globalizer="clr-namespace:WPFSharp.Globalizer;assembly=WPFSharp.Globalizer"
        xmlns:local="clr-namespace:ARK_Server_Manager"
        xmlns:vm="clr-namespace:ARK_Server_Manager.Lib.ViewModel"
        xmlns:eo="http://schemas.essentialobjects.com/wpf/"
        Title="{DynamicResource MainWindow_Title}" Height="800" Width="1024" Loaded="Window_Loaded"
        Name="Main" Icon="Art/favicon.ico">
	<Window.Resources>
        <vm:IpValidationRule x:Key="IpValidationRule"/>
		<SolidColorBrush x:Key="TabItem.Selected.Background" Color="#FFFFFF"/>
		<SolidColorBrush x:Key="TabItem.Selected.Border" Color="#ACACAC"/>
        <LinearGradientBrush x:Key="BeigeGradient" EndPoint="0.5,1" StartPoint="0.5,0">
            <GradientStop Color="#FFECE1D4" Offset="1"/>
            <GradientStop Color="#FFEAE8E6"/>
        </LinearGradientBrush>
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition/>
        </Grid.RowDefinitions>
        <DockPanel Grid.Row="0" Background="#FF4F4F4F" LastChildFill="False">
            <Grid DockPanel.Dock="Left">
                <Grid.RowDefinitions>
                    <RowDefinition/>
                    <RowDefinition/>
                </Grid.RowDefinitions>
                <TextBox Grid.Row="0" Background="#FF4F4F4F" Foreground="White" FontSize="26.667" FontWeight="Bold" Margin="5,0,5,0" Text="ARK Server Manager" BorderThickness="0"/>
                <StackPanel Grid.Row="1" Orientation="Horizontal">
                    <Label Margin="5,0,0,0" Background="#FF4F4F4F" Foreground="White" FontSize="12" Content="Version:" HorizontalAlignment="Right" VerticalAlignment="Center"/>
                    <Label Margin="5,0,0,0" Background="#FF4F4F4F" Foreground="White" FontSize="12" Content="{Binding Source={x:Static local:App.Instance}, Path=Version}" HorizontalAlignment="Right" VerticalAlignment="Center"/>
                    <Button Margin="5,0,0,0" Background="#00AA00" Foreground="White" Padding="1" BorderThickness="1" BorderBrush="White" ContentStringFormat="Upgrade to {0} now!" Content="{Binding LatestASMVersion}" Click="Upgrade_Click" VerticalAlignment="Center" >
                        <Button.Style>
                            <Style TargetType="{x:Type Button}">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding NewASMAvailable}" Value="True">
                                        <Setter Property="Visibility" Value="Visible"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding NewASMAvailable}" Value="False">
                                        <Setter Property="Visibility" Value="Collapsed"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                </StackPanel>
            </Grid>
            <Grid VerticalAlignment="Top" Margin="10,0,0,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Label Grid.Row="0" Margin="0" Background="#FF4F4F4F" Foreground="White" FontSize="10" Content="My Public IP:" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                <StackPanel Grid.Row="1" Orientation="Horizontal" VerticalAlignment="Center" Margin="5,0,0,0">
                    <TextBox FontSize="12"  Height="22" Width="250" VerticalAlignment="Bottom" Margin="0" VerticalContentAlignment="Center" ToolTip="The IP address players use to connect to your server.">
                        <Validation.ErrorTemplate>
                            <ControlTemplate>
                                <StackPanel>
                                    <!-- Placeholder for the TextBox itself -->
                                    <AdornedElementPlaceholder x:Name="textBox"/>
                                    <TextBlock Text="Invalid IP address or hostname" Background="Red" Foreground="White"/>
                                </StackPanel>
                            </ControlTemplate>
                        </Validation.ErrorTemplate>
                        <TextBox.Text>
                            <Binding Path="CurrentConfig.MachinePublicIP" ElementName="Main">
                                <Binding.ValidationRules>
                                    <vm:IpValidationRule ValidatesOnTargetUpdated="true" />
                                </Binding.ValidationRules>
                            </Binding>
                        </TextBox.Text>
                    </TextBox>
                    <Button Grid.Row="1" Width="22" Height="22" VerticalAlignment="Center" Margin="5,0,0,0" Click="RefreshPublicIP_Click"
                        ToolTip="Attempt to determine your current public IP">
                        <Image Source="Art/Refresh.png"/>
                    </Button>
                </StackPanel>
            </Grid>
            <StackPanel DockPanel.Dock="Right" VerticalAlignment="Center" Orientation="Horizontal" Margin="5">
                <Button Click="Donate_Click" Background="#00ffffff" Margin="5" Padding="5" ToolTip="Like what you see and want to show your appreciation?  Donate here!">
                    <Image Source="Art/Donate.png" />
                </Button>
                <Button Background="#00ffffff" Margin="5" Padding="5" ToolTip="Settings" Click="Settings_Click">
                    <Image Source="Art/Settings.png" Width="16"/>
                </Button>
                <Button Background="#00ffffff" Margin="5" Padding="5" ToolTip="Help" Click="Help_Click">
                    <Image Source="Art/Help.png" Width="16"/>
                </Button>
            </StackPanel>
 

        </DockPanel>
        <eo:TabControl Name="Tabs" Grid.Row ="1" Margin="0,5,0,-5" 
                       ShowCloseTabButton="True" ShowNewTabButton="True" 
                       NewItemRequested="Servers_AddNew"
                       PreviewItemClose="Servers_Remove"
                       ItemsSource="{Binding ServerManager.Servers}">
            <eo:TabControl.HeaderTemplate>
                <DataTemplate>
                    <Label Content="{Binding Profile.ProfileName}"/>
                </DataTemplate>
            </eo:TabControl.HeaderTemplate>
            <eo:TabControl.ContentTemplate>
                <DataTemplate>
                    <local:ServerSettingsControl Server="{Binding}"/>
                </DataTemplate>
            </eo:TabControl.ContentTemplate>
        </eo:TabControl>
    </Grid>
</Window>
